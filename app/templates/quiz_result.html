<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/static/css/common.css" />
    <link rel="stylesheet" href="/static/css/quiz-result-style.css" />
    <title>Quiz {{ quiz_id }} on {{ deck }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  </head>

  <body>

    <header>
      <div class="container">
        <a id="logo" href="/">
          <img
            src="/static/svg/stack.svg"
            alt="Stack Icon"
            width="48"
            height="48"
          />
          <h1>Recallr</h1>
        </a>
        <nav>
          <ul>
            {% if current_user.is_authenticated %}
            <li><a href="/deck">Decks</a></li>
            <button id="logout">Logout</button>
            {% else %}
            <li><a href="/signup">Sign Up</a></li>
            <li><a href="/login">Login</a></li>
            {% endif %}
            <li><a href="/help">Help</a></li>
          </ul>
        </nav>
      </div>
    </header>


    <div class="error-modal modal">
      {% with messages = get_flashed_messages() %} {% if messages %}
      <div class="flashes">
        <ul>
          {% for message in messages %}
          <li>{{ message }}</li>
          {% endfor %}
        </ul>
        <button>
          <span class="material-symbols-outlined icon-small"> close </span>
        </button>
      </div>
      {% endif %} {% endwith %}
    </div>


    <main>
      <div class="container">
        <div class="result-card">
          <div class="result-header">

            {% if result.correct >= (result.correct + result.wrong + result.unanswered) / 2 %}
                <span class="material-icons material-symbols-outlined icon-correct"> trophy </span>
            {% else %}
                <span class="material-icons material-symbols-outlined icon-wrong">cancel</span>
            {% endif %}

            <div class="header-message">
              <h2>
              {{ "Congratulations!" if result.correct >= (result.correct +
                result.wrong + result.unanswered) / 2 else "Try Again!" }}
              </h2>
              <p>You have completed the quiz.</p>
            </div>
          </div>

          <div class="result-overview">
            <h2>Quiz Result</h2>
            <div class="info">
              <p>Quiz ID:</p>
              <p>{{ result.quiz_id }}</p>
            </div>
            <div class="info">
              <p>Deck:</p>
              <p>{{ deck }}</p>
            </div>
            <hr />
            <div class="info score">
              <p>Score:</p>
              <p class="mark">
                <span>{{ result.correct }}</span> / {{ result.correct +
                result.wrong + result.unanswered }}
              </p>
            </div>
          </div>

          <div class="result-details">
            <div class="result-details-header">
              <h2>Questions Review</h2>
              <hr />
            </div>
            <div class="questions">
              {% for card_id, card in result.cards.items() %} {% if card.correct
              %}
              <div class="question-container correct">
                <span class="material-icons material-symbols-outlined">
                    check_circle
                </span>
                <div class="question">
                  <p class="question-text">{{ card.question }}</p>
                  <p class="user-answer-text">
                    Your Answer: {{ card.user_answer }}
                  </p>
                </div>
              </div>
              {% else %}

              <div class="question-container wrong">
                <span class="material-icons material-symbols-outlined">
                    cancel
                </span>
                <div class="question">
                  <p class="question-text">{{ card.question }}</p>
                  <p class="user-answer-text">
                    Your Answer: {{ card.user_answer }}
                  </p>
                  <p class="correct-answer-text">
                    Correct Answer: {{ card.answer }}
                  </p>
                </div>
              </div>
              {%endif %} {% endfor %}
            </div>
          </div>

          <div class="container actions">
            <a href="/deck/{{ deck_id }}" class="btn deck">
                <span class="material-symbols-outlined">arrow_back</span>
                <p>
                    {{ deck }}
                </p>
            </a>
            <a href="/deck" class="btn decks">
              <span class="material-symbols-outlined">home</span>
              <p>
                  Decks
              </p>
            </a>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2025 Recallr | All rights reserved</p>
    </footer>
    <script src="/static/js/errorModal.js"></script>
    <script src="/static/js/logout.js"></script>
  </body>
</html>

